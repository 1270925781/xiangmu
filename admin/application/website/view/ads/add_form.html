<form onsubmit="return false;" action="{:request()->url()}" data-auto="true" method="post" class='layui-form layui-card' autocomplete="off">

    <div class="layui-card-body">
        <div class="layui-row margin-bottom-15">
            <label class="layui-col-xs2 think-form-label">广告名称</label>
            <label class="layui-col-xs10">
                <input style="margin-left:15px" required maxlength="20" name="ad_name" required class="layui-input" placeholder="请输入广告名称" value="{$vo.ad_name|default=''}">
            </label>
        </div>
        <div class="layui-row margin-bottom-15">
            <label class="layui-col-xs2 think-form-label">轮播图片</label>
            <label class="layui-col-xs8 think-form-group-left">
                <input style="margin-left:15px" name="ad_img" required value='{$vo.ad_img|default=""}' placeholder="请上传轮播图片" class="layui-input">
            </label>
            <a class="layui-col-xs2 layui-btn think-form-group-right" data-file="btn" data-field="ad_img" data-type="png,jpg,gif">
                <i class="layui-icon layui-icon-upload"></i> 上传图片
            </a>
        </div>
        <div class="layui-row margin-bottom-15">
            <label class="layui-col-xs2 think-form-label"></label>
            <label class="layui-col-xs10 color-red help-block">&nbsp;&nbsp;图片尺寸(长*宽):(启动图/引导广告图750*1242,其余图片均为750*350,最大5M)
            </label>
        </div>
        <div style="display: flex;margin-left: 60px" class="layui-row margin-bottom-15">
            <div class="layui-row " style="display: flex;width:200px">
                <label class="layui-col-xs2 think-form-label" style="width: 75px;padding: 9px 5px">平台类型</label>
                <label class="layui-col-xs8 think-form-group-left" style="margin-left:15px">
                    <select class="layui-select" name="platform_type" id="platform_type"  lay-filter="platform_type" lay-search style="display: none;width:150px">
                        {foreach $platform_type as $pt}
                            {if isset($vo.platform_type) and $vo.platform_type eq $pt.id}
                            <option selected value="{$pt.id}">{$pt.name|default=''}</option>
                            {else}
                            <option value="{$pt.id}">{$pt.name|default=''}</option>
                            {/if}
                        {/foreach}
                    </select>
                </label>
            </div>
            <div class="layui-row " style="display: flex;width:200px">
                <label class="layui-col-xs2 think-form-label" style="width: 75px;padding: 9px 5px">广告位置</label>
                <label class="layui-col-xs8 think-form-group-left" style="margin-left:15px">
                    <select class="layui-select" name="location_id" id="location_id" lay-search style="display: none;width:150px">
                        <option value="">-- 全部 --</option>
                        {foreach $adlocation as $ad}
                            {if isset($vo.location_id) and $vo.location_id eq $ad.id}
                            <option selected value="{$ad.id}">{$ad.name|default=''}</option>
                            {else}
                            <option value="{$ad.id}">{$ad.name|default=''}</option>
                            {/if}
                        {/foreach}
                    </select>
                </label>
            </div>
            <div class="layui-row" style="display: flex;width:200px;margin-left: 40px">
                <label class="layui-col-xs2 think-form-label" style="width: 75px;padding: 9px 5px">广告类型</label>
                <label class="layui-col-xs8 think-form-group-left" style="margin-left:15px">
                    <select class="layui-select" name="ad_type" id="ad_type" lay-filter="ad_type" style="display: none;width:150px">
                        <option value="">-- 全部 --</option>
                        {foreach $adtype as $adt}
                            {if isset($vo.ad_type) and $vo.ad_type eq $adt.id}
                            <option selected value="{$adt.id}">{$adt.name|default=''}</option>
                            {else}
                            <option value="{$adt.id}">{$adt.name|default=''}</option>
                            {/if}
                        {/foreach}
                    </select>
                </label>
            </div>
            <a id="store" style="display: none;margin-left: 10px;margin-top: 3px" data-dbclick class="layui-btn layui-btn-sm" data-iframe='{:url("admin/publicv/shop")}'>获取ID</a> <!--展厅ID-->
            <a id="exhibition" style="display: none" data-dbclick class="layui-btn layui-btn-sm" data-iframe='{:url("edit")}'>获取ID</a> <!--展会ID-->
            <a id="activity" style="display: none" data-dbclick class="layui-btn layui-btn-sm" data-iframe='{:url("edit")}'>获取ID</a> <!--活动ID-->
            <a id="goods" style="display: none" data-dbclick class="layui-btn layui-btn-sm" data-iframe='{:url("admin/publicv/goods")}'>获取ID</a> <!--产品ID-->
            <a id="news" style="display: none" data-dbclick class="layui-btn layui-btn-sm" data-iframe='{:url("admin/publicv/news")}'>获取ID</a> <!--新闻ID-->
        </div>
        <div class="layui-row margin-bottom-15" style="display: block"  id="shop_id">
            <label class="layui-col-xs2 think-form-label">跳转ID</label>
            <label class="layui-col-xs10">
                <input readonly="readonly" style="margin-left:15px" name="route_id" id="jump_id" class="layui-input" placeholder="请输入跳转ID" value="{$vo.shop_id|default=''}">
            </label>
        </div>
        <div class="layui-row margin-bottom-15" style="display: none"  id="route">
            <label class="layui-col-xs2 think-form-label">跳转路径</label>
            <label class="layui-col-xs10">
                <input style="margin-left:15px" name="route" class="layui-input" placeholder="请输入跳转路径" value="{$vo.route|default=''}">
            </label>
        </div>
        <div class="layui-row margin-bottom-15">
            <label class="layui-col-xs2 think-form-label">开始时间</label>
            <label class="layui-col-xs10">
                <input style="margin-left:15px" type="text" id="starttime" name="starttime" class="layui-input" placeholder="请输入开始时间" value="{$vo.starttime|default=''}">
            </label>
        </div>
        <div class="layui-row margin-bottom-15">
            <label class="layui-col-xs2 think-form-label">结束时间</label>
            <label class="layui-col-xs10">
                <input style="margin-left:15px" type="text" id="endtime" name="endtime" class="layui-input" placeholder="请输入结束时间" value="{$vo.endtime|default=''}">
            </label>
        </div>
        <div class="layui-row margin-bottom-15">
            <label class="layui-col-xs2 think-form-label">排序</label>
            <label class="layui-col-xs10">
                <input style="margin-left:15px" name="sort" required class="layui-input" placeholder="请输入排序" value="{$vo.sort|default=''}">
            </label>
        </div>
    </div>
    <div class="hr-line-dashed"></div>
    <div class="layui-form-item text-center">
        {notempty name='vo.id'}<input type='hidden' value='{$vo.id}' name='id'>{/notempty}
        <button class="layui-btn" type='submit'>保存</button>
        <button class="layui-btn layui-btn-danger" type='button' data-confirm="确定要取消操作吗？" data-close>取消</button>
    </div>
</form>

<script>
layui.use(['form'], function(){
    var form = layui.form;
    form.on('select(ad_type)', function(data){
        var select =data.value;
        if(select == 1){
            $('#shop_id').css("display","block");
            $('#route').css("display","none");
            $('#store').css("display","block");
            $('#exhibition').css("display","none");
            $('#activity').css("display","none");
            $('#goods').css("display","none");
            $('#news').css("display","none");
        }else if(select == 2){
            $('#shop_id').css("display","block");
            $('#route').css("display","none");
            $('#exhibition').css("display","block");
            $('#activity').css("display","none");
            $('#store').css("display","none");
            $('#goods').css("display","none");
            $('#news').css("display","none");
        }else if(select == 3){
            $('#shop_id').css("display","block");
            $('#route').css("display","none");
            $('#activity').css("display","block");
            $('#goods').css("display","none");
            $('#store').css("display","none");
            $('#exhibition').css("display","none");
            $('#news').css("display","none");
        }else if(select == 4){
            $('#shop_id').css("display","block");
            $('#route').css("display","none");
            $('#news').css("display","none");
            $('#activity').css("display","none");
            $('#store').css("display","none");
            $('#exhibition').css("display","none");
            $('#goods').css("display","block");
        }else if(select == 5){
            $('#shop_id').css("display","block");
            $('#route').css("display","none");
            $('#activity').css("display","none");
            $('#store').css("display","none");
            $('#exhibition').css("display","none");
            $('#goods').css("display","none");
            $('#news').css("display","block");
        }else if(select == 6){
            $('#shop_id').css("display","none");
            $('#route').css("display","block");
            $('#activity').css("display","none");
            $('#store').css("display","none");
            $('#exhibition').css("display","none");
            $('#goods').css("display","none");
            $('#news').css("display","none");
        }else{
            $('#shop_id').css("display","none");
            $('#route').css("display","none");
            $('#activity').css("display","none");
            $('#store').css("display","none");
            $('#exhibition').css("display","none");
            $('#goods').css("display","none");
            $('#news').css("display","none");
        }
    });
    form.render("select");
 });
 layui.use(['form'], function(){
    var form = layui.form;
    form.on('select(platform_type)',function(data){
        var id =data.value;
        $.ajax({
            url:"{:url('getLocation')}",
            data:{'id':id},
            type:"Post",
            dataType:"json",
            success:function(data){
                console.log(data);
                var html="<option value='0'>--全部--</option>\n";
                for (var i = 0; i < data.length; i++) {
                    var res = data[i];
                    html += "<option value='"+res.id+"'>"+res.name+"</option>\n";
                }
                console.log(html);
                $("#location_id").html(html);
                window.form.render();
            }
        });
    });
 });
 var startDate=laydate.render({
        elem: '#starttime',
        type: 'datetime'
        ,min: '1990-01-01 00:00:01'
        ,max: '2099-12-31 23:59:59',
        value:getRecentDay(+1)+" 00:00:01",
        done:function(value,date){
            if(value!=""){
                date.month=date.month-1;
                endDate.config.min=date;
            }else{
                endDate.config.min=startDate.config.min;
            }
        },
    });
    var endDate=laydate.render({
        elem: '#endtime',
        type: 'datetime'
        ,min: '1990-01-01 00:00:01'
        ,max: '2099-12-31 23:59:59',
        value:getRecentDay(+31)+" 23:59:59",
        done:function(value,date){
            if(value!=""){
                date.month=date.month-1;
                startDate.config.max=date;
            }else{
                startDate.config.max=endDate.config.max;
            }
        }
    });
    /**获取近N天*/
    function getRecentDay(day){
        var today = new Date();
        var targetday_milliseconds=today.getTime() + 1000*60*60*24*day;
        today.setTime(targetday_milliseconds);
        var tYear = today.getFullYear();
        var tMonth = today.getMonth();
        var tDate = today.getDate();
        tMonth = doHandleMonth(tMonth + 1);
        tDate = doHandleMonth(tDate);
        return tYear+"-"+tMonth+"-"+tDate;
    }
    function doHandleMonth(month){
        var m = month;
        if(month.toString().length == 1){
            m = "0" + month;
        }
        return m;
    }
</script>

<style>
    .label-required-prev::before{
        content: ""
    }
    .think-form-group-left input{
        border-right: 1px solid #d2d2d2;
    }
    .layui-btn + .layui-btn {
        margin-left: 10px;
        margin-top: 3px;
    }
</style>